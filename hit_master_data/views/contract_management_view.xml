<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <data>
    <record model="ir.ui.view" id="contract_master_data_form">
      <field name="name">Contract Form</field>
      <field name="model">contract.master.data</field>
      <field name="arch" type="xml">
        <form>
          <header>
            <button name='activate_contract' string="Activate" type="object" attrs="{'invisible': [('state', '!=', 'draft')]}"></button>
            <button name='complete_contract' string="Complete" type="object" attrs="{'invisible': [('state', '!=', 'active')]}"></button>
            <button name='set_to_draft' string="Reset to Draft" type="object" attrs="{'invisible': [('state', '!=', 'done')]}"></button>
            <field name='state' widget="statusbar" statusbar_visible="draft,active,done"></field>
          </header>
          <sheet string='Create Contract'>
            <div class="oe_title">
              <h1>
                <field name="name" placeholder="Contract Number..."/>
              </h1>
            </div>
            <group>
              <group>
                <field name="project_id"/>
                <field name="customer_id"/>
                <field name="address"/>
                <field name="payment_bank"/>
                <field name="account_no" placeholder="Account No."/>
                <field name="bank_branch"/>
                <field name="scope_of_contract" placeholder="Contract Details"/>
              </group>
              <group>
                <field name="contract_duration"/>
                <field name="contract_time"/>
                <field name="start_of_contract"/>
                <field name="end_of_contract"/>
                <field name="contract_addendum"/>
                <field name="contract_amount"/>
              </group>
            </group>
            <group>
              <field name="other_information"/>
              <field name="scan_of_contract"/>
            </group>
            <notebook>
              <page string='Invoice'>
                <field name='account_move_ids'>
                  <tree>
                    <field name='name' decoration-bf="1" />
                    <field name="ref" optional="show"/>
                    <field name="date"/>
                    <field name="partner_id" invisible="1"/>
                    <field name="invoice_source_email" invisible="1"/>
                    <field name="invoice_partner_display_name" invisible="context.get('default_move_type') not in ('in_invoice', 'in_refund','in_receipt')" groups="base.group_user" string="Vendor"/>
                    <field name="invoice_partner_display_name" invisible="context.get('default_move_type') not in ('out_invoice', 'out_refund','out_receipt')" groups="base.group_user" string="Customer"/>
                    <field name="invoice_date" optional="show" invisible="context.get('default_move_type') not in ('in_invoice', 'in_refund','in_receipt')" string="Bill Date"/>
                    <field name="invoice_date" optional="show" invisible="context.get('default_move_type') not in ('out_invoice', 'out_refund','out_receipt')" string="Invoice Date"/>
                    <field name="invoice_date_due" widget="remaining_days" optional="show" attrs="{'invisible': [['payment_state', 'in', ('paid', 'in_payment', 'reversed')]]}"/>
                    <field name="amount_total_signed" string="Include Tax" sum="Total" optional="show"/>
                    <field name="invoice_origin" optional="hide" string="Source Document"/>
                    <field name="payment_reference" optional="hide" invisible="context.get('default_move_type') in ('out_invoice', 'out_refund','out_receipt')"/>
                    <field name="invoice_user_id" optional="hide" invisible="context.get('default_move_type') not in ('out_invoice', 'out_refund','out_receipt')" string="Sales Person" widget="many2one_avatar_user"/>
                    <field name="company_id" groups="base.group_multi_company" options="{'no_create': True}" optional="show"/>
                    <field name="amount_untaxed_signed" string="Tax Excluded" sum="Total" optional="hide"/>
                    <field name="amount_tax" optional="show" sum="Sum of Tax"/>
                    <field name="amount_tax_signed" string="Tax" sum="Total" optional="hide"/>
                    <field name="amount_untaxed" string="Total" sum="Sum of Total Untaxed" decoration-bf="1"/>
                    <field name="amount_residual_signed" string="Amount Due" sum="Amount Due" optional="hide"/>
                    <field name="currency_id" invisible="1"/>
                    <field name="company_currency_id" invisible="1"/>
                    <field name="state" widget="badge" decoration-success="state == 'posted'" decoration-info="state == 'draft'" optional="show"/>
                    <field name="payment_state" widget="badge" decoration-danger="payment_state == 'not_paid'" decoration-warning="payment_state in ('partial', 'in_payment')" decoration-success="payment_state in ('paid', 'reversed')" attrs="{'invisible': [('payment_state', 'in', ('invoicing_legacy'))]}" optional="show"/>
                    <field name="move_type" invisible="context.get('default_move_type', True)"/>
                  </tree>
                </field>
                <div invisible="1">
                  <field name='x_css'/>                
                </div>
              </page>
            </notebook>
          </sheet>
          <div class="oe_chatter">
            <field name="message_follower_ids" widget="mail_followers"/>
            <field name="message_ids" widget="mail_thread"/>
          </div>
        </form>
      </field>
    </record>

    <record model="ir.ui.view" id="contract_master_data_list">
      <field name="name">Contract List</field>
      <field name="model">contract.master.data</field>
      <field name="arch" type="xml">
        <tree>
          <field name="name"/>
          <field name="customer_id"/>
          <field name="project_id"/>
          <field name="state"/>
        </tree>
      </field>
    </record>

    <record model="ir.actions.act_window" id="action_contract_view">
      <field name="name">Contract Master Data</field>
      <field name="res_model">contract.master.data</field>
      <field name="view_mode">tree,form</field>
    </record>

    <menuitem id="menu_contract_master_data" parent="hit_master_data.root_master_data" name="Contract Management" sequence="3" action="action_contract_view"/>
  </data>
</odoo>